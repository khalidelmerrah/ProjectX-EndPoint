<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProjectX: Endpoint Protection Platform - Technical Report</title>
    <style>
        body {
            font-family: "Georgia", serif;
            /* Academic feel */
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }

        h1,
        h2,
        h3 {
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            color: #2c3e50;
        }

        h1 {
            text-align: center;
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 10px;
            margin-bottom: 40px;
        }

        .abstract {
            background-color: #fff;
            padding: 20px;
            border-left: 5px solid #3498db;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .code-block {
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            padding: 15px;
            font-family: "Consolas", monospace;
            overflow-x: auto;
            border-radius: 4px;
            font-size: 0.9em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #fff;
        }

        th,
        td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }

        th {
            background-color: #2c3e50;
            color: white;
        }

        .diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border: 1px dashed #ccc;
        }

        footer {
            text-align: center;
            margin-top: 50px;
            font-size: 0.8em;
            color: #777;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }

        .badge {
            background-color: #e74c3c;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8em;
            vertical-align: middle;
        }
    </style>
</head>

<body>

    <h1>ProjectX: Endpoint Protection Platform<br><small style="font-size: 0.5em; color: #7f8c8d;">Technical Design &
            Implementation Report</small></h1>

    <div class="abstract">
        <h3>Abstract</h3>
        <p>
            This document serves as the comprehensive technical reference for <strong>ProjectX</strong>, an
            academic-grade Endpoint Protection Platform (EPP) designed to demonstrate advanced concepts in
            cybersecurity, software architecture, and defensive programming.
            The system employs a <strong>Service-Oriented Architecture (SOA)</strong> for its business logic and a
            <strong>Model-View-Controller (MVC)</strong> pattern for its graphical interface.
            Key security features include Defense-in-Depth strategies, secure database interactions (prevention of SQL
            Injection), and real-time threat intelligence integration via OSQuery and NVD Data Feeds.
        </p>
    </div>

    <h2>1. System Architecture</h2>
    <p>
        ProjectX deviates from monolithic script structures by enforcing strict separation of concerns. This modularity
        ensures maintainability, testability, and scalability.
    </p>

    <h3>1.1 Design Patterns</h3>
    <ul>
        <li><strong>Singleton / Monostate:</strong> Used in Manager classes (`ConfigManager`, `DatabaseManager`) to
            ensure consistent state across the application lifecycle.</li>
        <li><strong>Observer Pattern (Signals & Slots):</strong> Implemented via PyQt6's signal system to decouple the
            UI from the background worker threads. This prevents "Freezing" during heavy operations.</li>
        <li><strong>Sidecar Pattern:</strong> The application leverages `osqueryi.exe` as a subprocess sidecar, treating
            the operating system as a queryable relational database.</li>
        <li><strong>Chain of Responsibility:</strong> Documented in `SoftwareManager`, where the system falls back from
            OSQuery to Registry and finally WMI to gather inventory data.</li>
    </ul>

    <div class="diagram">
        <strong>[Architecture Diagram Representation]</strong><br><br>
        UI Layer (PyQt6) <--> Worker Threads (QThread) <--> Managers (Business Logic) <--> Data Access (SQLite/APIs)
    </div>

    <h2>2. Core Modules</h2>

    <h3>2.1 Database Manager (`db_manager.py`)</h3>
    <p>
        The persistence layer is built on <strong>SQLite</strong> with strict ACID compliance.
    </p>
    <ul>
        <li><strong>Schema Design:</strong> Normalized tables for `assets`, `vulnerabilities`, `scan_history`, and
            `system_metrics`.</li>
        <li><strong>Security:</strong> Utilization of parameterized queries (`?` placeholders) to eliminate SQL
            Injection risks.</li>
        <li><strong>Data Integrity:</strong> Automatic foreign key constraints enabled via `PRAGMA foreign_keys = ON`.
        </li>
    </ul>

    <h3>2.2 Worker Threads (`workers.py`)</h3>
    <p>
        Concurrnecy is handled via `QThread`. Accessing the GUI from these threads is strictly prohibited; all
        communication occurs via Signals.
    </p>
    <table>
        <tr>
            <th>Worker Class</th>
            <th>Responsibility</th>
        </tr>
        <tr>
            <td>`ScanWorker`</td>
            <td>Orchestrates the entire system audit (Inventory -> Network -> CVEs).</td>
        </tr>
        <tr>
            <td>`FIMWorker`</td>
            <td>Real-time File Integrity Monitoring using the `watchdog` library.</td>
        </tr>
        <tr>
            <td>`AIWorker`</td>
            <td>Asynchronous interface to Large Language Models for threat explanation.</td>
        </tr>
    </table>

    <h3>2.3 Business Logic (`managers.py`)</h3>
    <p>
        The "Brain" of the application. The `InventoryManager` (renamed to `SoftwareManager` for clarity) aggregates
        data from multiple sources.
        The `VulnEngine` correlates this inventory against 120 days of NVD CVE data.
    </p>

    <h2>3. Security Mechanisms (Defense-in-Depth)</h2>
    <p>
        Security is not an add-on; it is baked into the code structure.
    </p>

    <h4>3.1 Secure Configuration (`ConfigManager`)</h4>
    <p>
        API Keys (e.g., for VirusTotal, NIST) are <strong>never</strong> stored in plaintext JSON files.
        The system uses the OS-native Keyring (Windows Credential Locker) to encrypt secrets using the user's login
        hash.
    </p>

    <h4>3.2 Input Sanitization</h4>
    <p>
        All inputs from external sources (Advisory Feed XML, VirusTotal JSON) are treated as untrusted.
        The `advisory_feed.py` crawler uses strict parsing to prevent Cross-Site Scripting (XSS) or Injection attacks if
        the data is rendered in a web view.
    </p>

    <h4>3.3 Least Privilege</h4>
    <p>
        The application attempts to run with standard user privileges where possible, only requesting elevation (UAC)
        for blocking IPs or terminating protected processes.
    </p>

    <h2>4. Conclusion</h2>
    <p>
        ProjectX serves as a robust educational platform for understanding modern endpoint protection.
        By inspecting the source code, students can observe the practical application of theoretical computer science
        and cybersecurity concepts.
    </p>

    <footer>
        &copy; 2025 University of Cybersecurity & Software Engineering | ProjectX Development Team
    </footer>

</body>

</html>